{"version":3,"file":"chat-widget.jsx","sourceRoot":"","sources":["chat-widget.tsx"],"names":[],"mappings":"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","sourcesContent":["\"use client\";\n\nimport { useState, useRef, useEffect, type FormEvent } from 'react';\nimport { Bot, Send, X, Loader2, Trash2, Expand, User, Sun, Moon } from 'lucide-react';\nimport type { Message } from '@/lib/types';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Card, CardContent, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Avatar, AvatarFallback } from '@/components/ui/avatar';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { cn } from '@/lib/utils';\nimport { useToast } from \"@/hooks/use-toast\";\nimport Image from 'next/image';\nimport alvinAvatar from '@/app/images/alvin-avatar.png';\nimport alvinIconWhite from '@/app/images/alvin-icon-white.png';\nimport { ChatMessage } from './chat-message';\n\nexport function ChatWidget() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [showTopics, setShowTopics] = useState(true);\n  const [inputValue, setInputValue] = useState('');\n  const [selectedTopic, setSelectedTopic] = useState<string | undefined>(undefined);\n  const [suggestedQuestions, setSuggestedQuestions] = useState<string[]>([]); // <-- new state\n  const [theme, setTheme] = useState('light');\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const smallChatScrollRef = useRef<HTMLDivElement>(null);\n  const expandedModalScrollRef = useRef<HTMLDivElement>(null);\n  const { toast } = useToast();\n\n  useEffect(() => {\n    if (theme === 'dark') {\n      document.documentElement.classList.add('dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n    }\n  }, [theme]);\n\n  const productionSuggestedTopics = [\n    {\n      category: \"Attendance & Time-Off Policies\",\n      topics: [\n        \"Perfect Attendance Policy\",\n        \"Service Incentive Leave Policy\", \n        \"Policy on Absences and Leave Application\",\n        \"Overtime Policy & Guidelines\"\n      ]\n    },\n    {\n      category: \"Conduct & Confidentiality\",\n      topics: [\n        \"The Company Code of Conduct\",\n        \"Confidentiality of Proprietary Information and Materials\",\n        \"Confidentiality of Client Information\",\n        \"Non-Disclosure and Intellectual Property Rights Agreement\"\n      ]\n    },\n    {\n      category: \"Operational Procedures & Guidelines\",\n      topics: [\n        \"Hybrid Work Arrangement Policy\",\n        \"Amendment on No Mobile Phone & Shared Locker Policy\",\n        \"Amendment on Cleanliness and Upkeep\",\n        \"EDT Common Inquiry Questions\",\n        \"Proper Submission of Selfies\",\n        \"Metrics for Daily QA\"\n      ]\n    }\n  ];\n\n  // Flatten all topics from all categories\n  const allTopics = productionSuggestedTopics.flatMap(cat => cat.topics);\n\n  useEffect(() => {\n    if (smallChatScrollRef.current) {\n      const scrollElement = smallChatScrollRef.current.querySelector('[data-radix-scroll-area-viewport]');\n      if (scrollElement) {\n        scrollElement.scrollTop = scrollElement.scrollHeight;\n      }\n    }\n  }, [messages, isLoading]);\n\n  useEffect(() => {\n    if (expandedModalScrollRef.current) {\n      const scrollElement = expandedModalScrollRef.current.querySelector('[data-radix-scroll-area-viewport]');\n      if (scrollElement) {\n        scrollElement.scrollTop = scrollElement.scrollHeight;\n      }\n    }\n  }, [messages, isLoading]);\n\n  useEffect(() => {\n    if (textareaRef.current) {\n      textareaRef.current.style.height = 'auto';\n      const scrollHeight = textareaRef.current.scrollHeight;\n      const maxHeight = 200; \n      textareaRef.current.style.height = `${Math.min(scrollHeight, maxHeight)}px`;\n    }\n  }, [inputValue]);\n  \n  const sendMessageWithTopic = async (messageText: string, topicOverride?: string) => {\n    if (!messageText.trim()) return;\n    setSuggestedQuestions([]); // Hide suggestions immediately\n\n    const userMessage: Message = { id: crypto.randomUUID(), role: 'user', content: messageText };\n    setMessages(prev => [...prev, userMessage]);\n    setIsLoading(true);\n    setShowTopics(false);\n\n    try {\n      // Convert messages to conversation history format for API\n      const conversationHistory = messages.map(msg => ({\n        role: msg.role,\n        content: msg.content\n      }));\n      \n      // Use the topic override if provided, otherwise use selected topic\n      const currentTopic = topicOverride || selectedTopic;\n      \n      // Log the message and topic being sent\n      console.log('📤 Sending to AI:', { message: messageText, topic: currentTopic });\n      console.log('🎯 Selected Topic State:', selectedTopic);\n      console.log('🎯 Topic Override:', topicOverride);\n\n      // Send to the same API endpoint used by the main page\n      const response = await fetch('/api/v1/chat', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ \n          message: messageText, \n          topic: currentTopic,\n          conversationHistory \n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to get response from AI');\n      }\n\n      const data = await response.json();\n      const aiResponse = data.text;\n\n      const botMessage: Message = { id: crypto.randomUUID(), role: 'assistant', content: aiResponse };\n      setMessages(prev => [...prev, botMessage]);\n    } catch (error) {\n       toast({\n        title: \"Error\",\n        description: \"Failed to get a response from the bot. Please try again.\",\n        variant: \"destructive\",\n      });\n      setMessages(prev => prev.slice(0, -1));\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const sendMessage = async (messageText: string) => {\n    setSuggestedQuestions([]); // Hide suggestions immediately\n    await sendMessageWithTopic(messageText);\n  };\n\n  const handleSubmit = async (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    sendMessage(inputValue);\n    setInputValue('');\n  };\n\n  const handleTopicSelect = async (topic: string) => {\n    setShowTopics(false);\n    setIsLoading(true);\n    setSuggestedQuestions([]);\n    setSelectedTopic(topic);\n\n    // Add bot intro message using the topic\n    const botMessage: Message = {\n      id: crypto.randomUUID(),\n      role: 'assistant',\n      content: `Great! I'm now focused on **${topic}**. I can help you with questions about this policy. What would you like to know?`\n    };\n    setMessages(prev => [...prev, botMessage]);\n\n    // Fetch suggested questions from API using the topic\n    try {\n      const response = await fetch('/api/v1/suggestions', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ categoryName: topic })\n      });\n      if (response.ok) {\n        const data = await response.json();\n        setSuggestedQuestions(data.suggestions || []);\n      } else {\n        setSuggestedQuestions([]);\n      }\n    } catch (e) {\n      setSuggestedQuestions([]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const clearChat = () => {\n    setMessages([]);\n    setShowTopics(true);\n    setSelectedTopic(undefined);\n  };\n\n  // Helper to determine if suggestions should be shown\n  const shouldShowSuggestions = suggestedQuestions.length > 0 && !messages.some(m => m.role === 'user') && !isLoading;\n\n  return (\n    <div>\n      {/* Overlay for mobile when chat is open */}\n      {(isOpen || isExpanded) && <div className=\"fixed inset-0 bg-black/30 md:hidden\" onClick={() => { setIsOpen(false); setIsExpanded(false); }} />}\n      \n      {/* Expanded Modal View */}\n      {isExpanded && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50\">\n           <div className=\"w-full max-w-5xl h-[80vh] flex flex-row rounded-2xl border-border bg-card overflow-hidden\">\n             {/* Left Panel: Chat */}\n             <div className=\"w-4/5 flex flex-col\">\n               <Card className=\"h-full flex flex-col shadow-none rounded-none border-0\">\n                <CardHeader className=\"flex flex-row items-center justify-between p-4 border-b bg-gradient-to-r from-blue-50 to-slate-50 dark:from-blue-950 dark:to-slate-950 shadow-sm text-blue-900 dark:text-white\">\n                <div className=\"flex items-center gap-3\">\n                <Avatar>\n                  <AvatarFallback className=\"bg-primary text-primary-foreground\">\n                    <Bot />\n                  </AvatarFallback>\n                </Avatar>\n                <CardTitle className=\"text-lg font-semibold text-blue-900 dark:text-white\">Alvin Helpdesk</CardTitle>\n              </div>\n                  <div className=\"flex items-center gap-1\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      className=\"h-8 w-8 text-blue-900 dark:text-white hover:bg-blue-100 dark:hover:bg-blue-900/40 group transition\"\n                      onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')}\n                    >\n                      {theme === 'dark'\n                        ? <Sun className=\"h-5 w-5\" />\n                        : <Moon className=\"h-5 w-5 group-hover:text-blue-700 transition\" />}\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-muted-foreground hover:bg-red-600/80 transition\" onClick={clearChat}>\n                      <Trash2 className=\"h-5 w-5\" />\n                    </Button>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      className=\"h-8 w-8 text-blue-900 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-700/60 group transition\"\n                      onClick={() => setIsExpanded(false)}\n                    >\n                      <X className=\"h-5 w-5 group-hover:text-blue-700 dark:group-hover:text-white transition\" />\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"flex-1 p-0 flex flex-col min-h-0\">\n                  <ScrollArea className=\"flex-1 h-full\" ref={expandedModalScrollRef}>\n                    <div className=\"space-y-6 p-6\">\n                      {messages.map((message) => (\n                        <div key={message.id}>\n                          <ChatMessage\n                            message={message}\n                            theme={theme}\n                          />\n                        </div>\n                      ))}\n                      {isLoading && (\n                        <div className=\"flex items-start gap-3 justify-start animate-in fade-in duration-300\">\n                          <Avatar className=\"h-8 w-8 border\">\n                            <AvatarFallback className=\"bg-card\">\n                              <Bot className=\"h-5 w-5\"/>\n                            </AvatarFallback>\n                          </Avatar>\n                          <div className=\"bg-card text-card-foreground border rounded-lg px-4 py-3 flex items-center shadow-sm\">\n                            <span className=\"text-sm\">Thinking</span>\n                            <span className=\"animate-pulse ml-1\">.</span>\n                            <span className=\"animate-pulse delay-150\">.</span>\n                            <span className=\"animate-pulse delay-300\">.</span>\n                          </div>\n                        </div>\n                      )}\n                       \n                      {showTopics && !isLoading && (\n                        <div className=\"flex flex-col items-center justify-center min-h-[60vh] text-center text-muted-foreground\">\n                          <h3 className=\"text-base sm:text-lg md:text-xl lg:text-2xl font-semibold font-headline text-foreground mb-1 sm:mb-2 md:mb-3\">\n                            Ask me anything...\n                          </h3>\n                          <p className=\"text-xs sm:text-sm md:text-base mb-3 sm:mb-4 md:mb-6 text-foreground px-2 sm:px-4\">\n                            Choose a category below or type your question directly\n                          </p>\n                          <div className=\"topic-cards grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-1 sm:gap-1.5 md:gap-2 lg:gap-3 w-full max-w-3xl mx-auto px-1 sm:px-2 md:px-4\">\n                            {productionSuggestedTopics.map((category, index) => (\n                              <div\n                                key={category.category}\n                                className=\"group cursor-pointer\"\n                                onClick={() => handleTopicSelect(category.category)}\n                              >\n                                <div className=\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 hover:shadow-md dark:hover:shadow-lg transition-all duration-300 rounded-md p-1 sm:p-1.5 md:p-2 lg:p-3 h-full relative overflow-hidden group\">\n                                  {/* Moving light beam on edges only - hover effect */}\n                                  <div className=\"absolute inset-0 rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-0\">\n                                    <div className=\"absolute top-0 left-0 w-full h-0.5 bg-gradient-to-r from-transparent via-blue-400 to-transparent animate-shimmer-x\"></div>\n                                    <div className=\"absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-transparent via-blue-400 to-transparent animate-shimmer-x delay-500\"></div>\n                                    <div className=\"absolute top-0 left-0 w-0.5 h-full bg-gradient-to-b from-transparent via-blue-400 to-transparent animate-shimmer-y\"></div>\n                                    <div className=\"absolute top-0 right-0 w-0.5 h-full bg-gradient-to-b from-transparent via-blue-400 to-transparent animate-shimmer-y delay-1000\"></div>\n                                  </div>\n                                  <div className=\"flex flex-col items-center text-center space-y-0.5 sm:space-y-1 md:space-y-1.5\">\n                                    {/* Category Icon */}\n                                    <div className=\"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 lg:w-8 lg:h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-sm\">\n                                      <span className=\"text-white font-bold text-xs sm:text-sm md:text-base\">\n                                        {index + 1}\n                                      </span>\n                                    </div>\n                                    \n                                    {/* Category Title */}\n                                    <h3 className=\"font-medium text-gray-800 dark:text-gray-200 text-xs sm:text-sm md:text-base lg:text-lg leading-tight px-0.5\">\n                                      {category.category}\n                                    </h3>\n                                    \n                                    {/* Topic Count */}\n                                    <div className=\"flex items-center space-x-0.5 sm:space-x-1\">\n                                      <div className=\"w-0.5 h-0.5 sm:w-1 sm:h-1 bg-blue-500 rounded-full\"></div>\n                                      <span className=\"text-xs text-gray-600 dark:text-gray-400 font-medium\">\n                                        {category.topics.length} topics\n                                      </span>\n                                    </div>\n                                    \n                                    {/* Hover Effect */}\n                                    <div className=\"w-full h-0.5 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300\"></div>\n                                  </div>\n                                </div>\n                              </div>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n                      {messages.length > 0 && suggestedQuestions.length > 0 && (\n                        <div className=\"flex flex-wrap gap-2 mt-2\">\n                          {suggestedQuestions.map((q, idx) => (\n                            <Button\n                              key={idx}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => sendMessage(q)}\n                              className=\"text-xs hover:bg-blue-50 hover:border-blue-300 hover:text-blue-700 dark:hover:bg-blue-950 dark:hover:border-blue-600 dark:hover:text-blue-300\"\n                            >\n                              {q}\n                            </Button>\n                          ))}\n                        </div>\n                      )}\n                      <div ref={messagesEndRef} />\n                    </div>\n                  </ScrollArea>\n                </CardContent>\n                <CardFooter className=\"p-4 border-t\">\n                  <form onSubmit={handleSubmit} className=\"flex w-full items-center gap-2\">\n                    <Textarea\n                      ref={textareaRef}\n                      name=\"message\"\n                      placeholder=\"Type a message...\"\n                      className=\"flex-1 resize-none overflow-y-auto min-h-[48px] max-h-[96px] py-2 px-3 text-sm rounded-md dark-scrollbar\"\n                      value={inputValue}\n                      onChange={(e) => setInputValue(e.target.value)}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter' && !e.shiftKey) {\n                          e.preventDefault();\n                          sendMessage(inputValue);\n                          setInputValue('');\n                        }\n                      }}\n                      disabled={isLoading}\n                      autoComplete=\"off\"\n                    />\n                    <Button type=\"submit\" size=\"icon\" variant=\"default\" disabled={isLoading || !inputValue.trim()} className=\"h-8 w-8 ml-2 p-0 flex items-center justify-center\">\n                      <Send className=\"h-4 w-4\" />\n                    </Button>\n                  </form>\n                </CardFooter>\n               </Card>\n             </div>\n             {/* Right Panel: Branding */}\n             <div className=\"w-1/3 text-white flex flex-col items-center justify-start p-8 relative overflow-hidden\">\n                <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <Image \n                        src={alvinAvatar.src} \n                        alt=\"Alvin Avatar\"\n                        fill\n                        className=\"object-cover\"\n                        priority\n                    />\n                </div>\n                <div className='flex flex-col items-center text-center relative'>\n                    <h2 className=\"text-4xl font-bold mb-2 text-blue-300\">Alvin</h2>\n                    <p className=\"text-2xl mb-8\">AI Helpdesk</p>\n                </div>\n             </div>\n           </div>\n        </div>\n      )}\n\n      {/* Chat Widget */}\n      <div className=\"fixed bottom-4 right-4 z-40 flex flex-col items-end gap-4\">\n        <div className={cn(\n          \"transition-all duration-300 ease-in-out transform\", \n          isOpen && !isExpanded ? \"opacity-100 scale-100\" : \"opacity-0 scale-95 pointer-events-none\"\n        )}>\n          <Card className=\"w-[calc(100vw-32px)] sm:w-[380px] h-[60vh] sm:h-[550px] flex flex-col rounded-2xl border-border\">\n            <CardHeader className=\"flex flex-row items-center justify-between bg-primary text-primary-foreground p-4 rounded-t-2xl\">\n              <div className=\"flex items-center gap-1 min-w-0\">\n                <Avatar className=\"bg-transparent border-none shadow-none\">\n                  <AvatarFallback className=\"bg-transparent p-0 text-white\">\n                    <img src={alvinIconWhite.src} alt=\"Alvin Bot\" className=\"h-8 w-8 object-contain\" />\n                  </AvatarFallback>\n                </Avatar>\n                <CardTitle className=\"text-lg font-semibold text-white self-center\">Alvin Helpdesk</CardTitle>\n              </div>\n              <div className=\"flex items-center gap-1\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-8 w-8 text-blue-900 dark:text-white hover:bg-blue-100 dark:hover:bg-blue-900/40 group transition\"\n                  onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')}\n                >\n                  {theme === 'dark'\n                    ? <Sun className=\"h-5 w-5\" />\n                    : <Moon className=\"h-5 w-5 group-hover:text-blue-700 transition\" />}\n                </Button>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-8 w-8 text-white hover:bg-blue-700/80 transition\"\n                  onClick={() => setIsExpanded(true)}\n                >\n                  <Expand className=\"h-5 w-5\" />\n                </Button>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-8 w-8 text-white hover:bg-red-600/80 transition\"\n                  onClick={clearChat}\n                >\n                  <Trash2 className=\"h-5 w-5\" />\n                </Button>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-8 w-8 text-white hover:bg-gray-700/80 transition\"\n                  onClick={() => setIsOpen(false)}\n                >\n                  <X className=\"h-5 w-5\" />\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent className=\"flex-1 p-0 flex flex-col min-h-0\">\n                {showTopics && !isLoading && (\n                    <div className=\"flex flex-col items-center justify-center min-h-[60vh] text-center bg-white dark:bg-[#181f2a] text-black dark:text-white px-4 pb-16 sm:pb-20 md:pb-24 lg:pb-28 xl:pb-32 xl-mid:pb-5 2xl:pb-48\">\n                        <h1 className=\"text-xl font-bold text-black dark:text-white break-words leading-snug\">Ask me anything...</h1>\n                        <p className=\"text-xs text-gray-600 dark:text-gray-300 pb-8 break-words\">Choose a category below or type your question directly</p>\n                        <div className=\"flex flex-col gap-2 w-full max-w-md mx-auto\">\n                            {productionSuggestedTopics.map((category, index) => (\n                            <div\n                                key={category.category}\n                                className=\"group cursor-pointer\"\n                                onClick={() => handleTopicSelect(category.category)}\n                            >\n                                <div className=\"bg-gray-100 dark:bg-[#232b3b] border border-gray-200 dark:border-gray-700 hover:shadow-md transition-all duration-300 rounded-lg p-2 text-left relative overflow-hidden group\">\n                                <div className=\"flex items-center gap-2 relative z-10 min-w-0\">\n                                    <div className=\"w-5 h-5 bg-blue-600 dark:bg-blue-400 rounded-full flex items-center justify-center flex-shrink-0\">\n                                    <span className=\"text-white font-bold text-xs\">{index + 1}</span>\n                                    </div>\n                                    <div>\n                                    <h3 className=\"font-semibold text-black dark:text-white text-xs line-clamp-1\">{category.category}</h3>\n                                    <p className=\"text-gray-600 dark:text-gray-300 text-xs line-clamp-1\">• {category.topics.length} topics</p>\n                                    </div>\n                                </div>\n                                </div>\n                            </div>\n                            ))}\n                        </div>\n                    </div>\n                )}\n              <ScrollArea className=\"flex-1 h-full\" ref={smallChatScrollRef}>\n                <div className=\"space-y-6 p-4\">\n                  {messages.map((message) => (\n                    <div key={message.id}>\n                      <ChatMessage\n                        message={message}\n                        theme={theme}\n                      />\n                    </div>\n                  ))}\n                  {isLoading && (\n                     <div className=\"flex items-start gap-3 justify-start animate-in fade-in duration-300\">\n                        <Avatar className=\"h-8 w-8 border\">\n                           <AvatarFallback className=\"bg-card\">\n                              <Bot className=\"h-5 w-5\"/>\n                           </AvatarFallback>\n                        </Avatar>\n                        <div className=\"bg-card text-card-foreground border rounded-lg px-4 py-3 flex items-center shadow-sm\">\n                            <span className=\"text-sm\">Thinking</span>\n                            <span className=\"animate-pulse ml-1\">.</span>\n                            <span className=\"animate-pulse delay-150\">.</span>\n                            <span className=\"animate-pulse delay-300\">.</span>\n                        </div>\n                    </div>\n                  )}\n                  {messages.length > 0 && suggestedQuestions.length > 0 && (\n                    <div className=\"flex flex-wrap justify-center gap-2 mt-2 px-2\">\n                      {suggestedQuestions.map((q, idx) => (\n                        <Button\n                          key={idx}\n                          variant=\"outline\"\n                          size=\"sm\"\n                          className=\"whitespace-normal break-words text-xs px-3 py-1 max-w-[70%]\"\n                          onClick={() => sendMessage(q)}\n                        >\n                          {q}\n                        </Button>\n                      ))}\n                    </div>\n                  )}\n                  <div ref={messagesEndRef} />\n                </div>\n              </ScrollArea>\n            </CardContent>\n            <CardFooter className=\"p-4 border-t\">\n              <form onSubmit={handleSubmit} className=\"flex w-full items-center gap-2\">\n                <Textarea\n                  ref={textareaRef}\n                  name=\"message\"\n                  placeholder=\"Type a message...\"\n                  className=\"flex-1 resize-none overflow-y-auto min-h-[48px] max-h-[96px] py-2 px-3 text-sm rounded-md dark-scrollbar\"\n                  value={inputValue}\n                  onChange={(e) => setInputValue(e.target.value)}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' && !e.shiftKey) {\n                      e.preventDefault();\n                      sendMessage(inputValue);\n                      setInputValue('');\n                    }\n                  }}\n                  disabled={isLoading}\n                  autoComplete=\"off\"\n                />\n                <Button type=\"submit\" size=\"icon\" variant=\"default\" disabled={isLoading || !inputValue.trim()} className=\"h-8 w-8 ml-2 p-0 flex items-center justify-center\">\n                  <Send className=\"h-4 w-4\" />\n                </Button>\n              </form>\n            </CardFooter>\n          </Card>\n        </div>\n\n        <button\n          aria-label=\"Open Chat\"\n          className={cn(\n            \"group relative flex items-center justify-end rounded-full w-16 h-16 transition-all duration-300 ease-in-out focus:outline-none\",\n            isOpen ? \"hidden\" : \"block\",\n            \"hover:w-[280px] hover:bg-muted\"\n          )}\n          onClick={() => setIsOpen(true)}\n        >\n          <div className=\"absolute left-0 top-0 flex h-16 w-16 items-center justify-center rounded-full bg-primary text-primary-foreground transition-all duration-300 ease-in-out group-hover:left-0\">\n            <img src={alvinIconWhite.src} alt=\"Alvin Bot\" className=\"h-8 w-8 object-contain\" />\n          </div>\n          <div className=\"pr-8 pl-20 opacity-0 transition-opacity duration-300 group-hover:opacity-100 max-w-xs\">\n            <p className=\"text-sm text-muted-foreground truncate group-hover:whitespace-normal\">\n              how can I assist you today?\n            </p>\n          </div>\n        </button>\n      </div>\n    </div>\n  );\n}\n"]}